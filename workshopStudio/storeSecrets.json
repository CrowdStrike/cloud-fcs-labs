{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Stores Parameters and Secrets for later use",
    "Parameters": {
        "FalconSecretName": {
            "Description": "Name of the Secrets Manager secret",
            "Type": "String",
            "Default": "crowdstrike-falcon-api"
        },
        "FalconClientID": {
            "Description": "Your Falcon OAuth2 Client ID.",
            "NoEcho": "true",
            "Type": "String",
            "Default": ""
        },
        "FalconClientSecret": {
            "Description": "Your Falcon OAuth2 API Secret.",
            "NoEcho": "true",
            "Type": "String",
            "Default": ""
        },
        "FalconCID": {
            "Description": "Falcon Customer ID",
            "NoEcho": "true",
            "Type": "String",
            "Default": ""
        },
        "CrowdStrikeCloud": {
            "Type": "String",
            "Default": "",
            "Description": "The cloud region where your Falcon CID is hosted (use either us-1, us-2, or eu-1)"
        }
    },
    "Resources": {
        "FalconSecrets": {
            "Type": "AWS::SecretsManager::Secret",
            "Properties": {
                "Name": "crowdstrike-falcon-api",
                "Description": "Client ID and Secret for the Falcon API",
                "SecretString": {
                    "Fn::Sub": "{\n  \"FalconClientId\":\"${FalconClientID}\", \n  \"FalconSecret\":\"${FalconClientSecret}\",\n  \"FalconCID\":\"${FalconCID}\",\n  \"CSCloud\":\"${CrowdStrikeCloud}\" \n}\n"
                }
            }
        }
    },
    "Outputs": {
        "FalconSecretArn": {
          "Description": "The ARN of the Falcon Secrets Manager secret",
          "Value": {
            "Ref": "FalconSecrets"
          },
          "Export": {
            "Name": "FalconSecretArn"
          }
        }
    }
}